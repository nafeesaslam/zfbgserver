'use strict';function xa(a){for(;a>m;)a-=2*m;for(;a<-m;)a+=2*m;return a}function ya(a,b){for(let c=0;c<a.s.length;c++){let e=a.s[c];if(e.v===b)return e}return null}function za(){var a=p;return(a=ya(a,a.B))&&0<a.o}function t(a,b,c){let e=new Float32Array(3);e[0]=a;e[1]=b;e[2]=c;return e}
function Aa(a){var b=w,c=Ba,e=x.j;let d=[],f=[];d[0]=a[0]-c[0];d[1]=a[1]-c[1];d[2]=a[2]-c[2];f[0]=d[2]*Math.sin(e)+d[0]*Math.cos(e);f[1]=d[1];f[2]=d[2]*Math.cos(e)-d[0]*Math.sin(e);b[0]=f[0]+c[0];b[1]=f[1]+c[1];b[2]=f[2]+c[2]};function Ca(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function Fa(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1}
function Ga(a,b,c){var e=Math.sin(c);c=Math.cos(c);var d=b[0],f=b[1],k=b[2],g=b[3],h=b[8],l=b[9],q=b[10],v=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=d*c-h*e;a[1]=f*c-l*e;a[2]=k*c-q*e;a[3]=g*c-v*e;a[8]=d*e+h*c;a[9]=f*e+l*c;a[10]=k*e+q*c;a[11]=g*e+v*c};function Ha(a){this.usage=a;this.C=new Float32Array(65536);this.g=new Float32Array(65536);this.i=new Uint16Array(65536);Ia(this)}function Ia(a){a.K=0;a.S=0;a.h=0;a.j=0}
function Ja(a,b,c,e,d,f){const k=a.K;for(var g=0;4>g;g++){for(var h=0;3>h;h++)a.C[a.S++]=b[g][h];a.K++}g=d||16;b=c/128;d=e/128;c=(c+g)/128;e=(e+(f||g))/128;a.g[a.h++]=b;a.g[a.h++]=d;a.g[a.h++]=c;a.g[a.h++]=d;a.g[a.h++]=c;a.g[a.h++]=e;a.g[a.h++]=b;a.g[a.h++]=e;a.i[a.j++]=k;a.i[a.j++]=k+1;a.i[a.j++]=k+2;a.i[a.j++]=k;a.i[a.j++]=k+2;a.i[a.j++]=k+3}function Ka(a){var b=y;a.m=b.createBuffer();a.I=b.createBuffer();a.l=b.createBuffer();La(a,b)}
function La(a,b){b.bindBuffer(34962,a.m);b.bufferData(34962,a.C,a.usage);b.bindBuffer(34962,a.I);b.bufferData(34962,a.g,a.usage);b.bindBuffer(34963,a.l);b.bufferData(34963,a.i,a.usage)}
function Ma(a){var b=y,c=Na,e=Oa;b.bindBuffer(34962,a.m);b.vertexAttribPointer(c.G.M,3,5126,!1,0,0);b.enableVertexAttribArray(c.G.M);b.bindBuffer(34962,a.I);b.vertexAttribPointer(c.G.J,2,5126,!1,0,0);b.enableVertexAttribArray(c.G.J);b.bindBuffer(34963,a.l);b.useProgram(c.P);b.uniformMatrix4fv(c.L.R,!1,Pa);b.uniformMatrix4fv(c.L.O,!1,Qa);b.activeTexture(33984);b.bindTexture(3553,e);b.drawElements(4,a.j,5123,0)}
window.addEventListener("message",a=>{"moveLeftDown"===a.data.action&&z(65,!0);"moveLeftUp"===a.data.action&&z(65,!1);"moveRightDown"===a.data.action&&z(68,!0);"moveRightUp"===a.data.action&&z(68,!1);"moveUpDown"===a.data.action&&z(87,!0);"moveUpUp"===a.data.action&&z(87,!1);"moveDownDown"===a.data.action&&z(83,!0);"moveDownUp"===a.data.action&&z(83,!1);"jumpDown"===a.data.action&&z(32,!0);"jumpUp"===a.data.action&&z(32,!1);if("fireStart"===a.data.action){var b=new KeyboardEvent("keydown",{key:"f",
keyCode:70,which:70,bubbles:!0});window.dispatchEvent(b)}"fireStop"===a.data.action&&(b=new KeyboardEvent("keyup",{key:"f",keyCode:70,which:70,bubbles:!0}),window.dispatchEvent(b));"pointerLockChange"===a.data.action&&(b=new PointerEvent("pointerlockchange",{bubbles:!0}),window.dispatchEvent(b));"zoomToggle"===a.data.action&&("function"===typeof jb&&jb(),console.log("BufferSet: Zoom toggle from iframe"));"zoomOut"===a.data.action&&(a=new WheelEvent("wheel",{deltaY:100,bubbles:!0}),document.dispatchEvent(a),
console.log("BufferSet: Zoom reset from iframe"))});function kb(){this.g=!1;this.h=0}const B=Array(256);for(let a=0;256>a;a++)B[a]=new kb;document.addEventListener("keydown",function(a){console.log("keydown",a.keyCode);z(a.keyCode,!0)});document.addEventListener("keyup",function(a){z(a.keyCode,!1)});function z(a,b){0<=a&&256>a&&(B[a].g=b)};function lb(a,b,c){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return b};const D=new AudioContext,mb=D.sampleRate,nb=D.createBuffer(1,mb,mb),ob=nb.getChannelData(0);for(let a=0;a<mb;a++)ob[a]=2*Math.random()-1;
function pb(a,b){if(!(500<a)){var c=b||1;b=1-a/500;var e=b*b,d=1E3-a;b=5E3-10*a;a=Math.max(1,10-a/50);var f=D.currentTime,k=D.createGain();k.gain.value=0;k.gain.setValueAtTime(10*e,f);k.gain.exponentialRampToValueAtTime(.001,f+.7*c);k.gain.setValueAtTime(0,f+c);k.connect(D.destination);c=D.createBiquadFilter();c.type="lowpass";c.Q.value=1;c.frequency.value=d;c.connect(k);d=D.createBiquadFilter();d.type="lowshelf";d.frequency.value=b;d.gain.value=a;d.connect(c);b=D.createBufferSource();b.buffer=nb;
b.connect(d);b.start()}}const qb=D.createGain();qb.connect(D.destination);qb.gain.setTargetAtTime(.04,0,.01);let rb=null,sb=null;function tb(a){return new Promise((b,c)=>{const e=new XMLHttpRequest;e.open("GET",a,!0);e.responseType="arraybuffer";e.onload=function(){200===e.status?D.decodeAudioData(e.response,function(d){b(d)},function(d){c(d)}):c(Error("Failed to load music file: "+e.status))};e.onerror=function(){c(Error("Failed to load music file"))};e.send()})}
function ub(){sb?"suspended"===D.state?(console.log("Audio context suspended, attempting to resume..."),D.resume().then(()=>{console.log("Audio context resumed successfully");vb()}).catch(a=>{console.error("Failed to resume audio context:",a)})):vb():console.warn("No music buffer loaded")}function vb(){wb();rb=D.createBufferSource();rb.buffer=sb;rb.loop=!0;rb.connect(qb);rb.start();console.log("Music started playing")}function wb(){rb&&(rb.stop(),rb=null)}
(function(a){tb(a).then(function(b){sb=b;console.log("Music loaded successfully")}).catch(function(b){console.error("Failed to load music:",b)})})("/battleThemeA.mp3");let xb=null,Bb=document.createElement("canvas");Bb.width=1024;Bb.height=1024;let I=Bb.getContext("2d");
function Cb(a,b,c,e){J.fillStyle="#323e30";J.fillRect(a,b,c,c);if(xb){I.drawImage(xb,0,0,1024,1024,0,0,1024,1024);const g=(x.x- -500)/1E3*1024,h=(500-x.z)/1E3*1024;var d=p.currentTime;if(0<d){var f=va(K,d),k=f.g/1E3*1024;I.fillStyle=Db(.66,1,1,.5);I.beginPath();I.arc((f.x- -500)/1E3*1024,(500-f.z)/1E3*1024,k,0,2*m);I.rect(1024,0,-1024,1024);I.fill();d=ua(K,d);f=d.g/1E3*1024;k=(d.x- -500)/1E3*1024;let l=(500-d.z)/1E3*1024;I.strokeStyle="#fff";I.beginPath();I.arc(k,l,f,0,2*m);I.rect(1024,0,-1024,1024);
I.lineWidth=2;I.stroke();oa(d,x)&&(I.lineWidth=1,I.strokeStyle="#fff",I.beginPath(),I.moveTo(g,h),I.lineTo(k,l),I.stroke())}I.beginPath();I.moveTo(g,h);I.arc(g,h,60,x.j-.16*m-.5*m,x.j+.16*m-.5*m);I.fillStyle=Db(0,0,1,.5);I.fill();I.beginPath();I.arc(g,h,5,0,2*m);I.fillStyle="red";I.fill();I.lineWidth=2;I.strokeStyle="#fff";I.stroke();e?J.drawImage(Bb,0,0,1024,1024,a,b,c,c):J.drawImage(Bb,g-c/2,h-c/2,c,c,a,b,c,c)}J.strokeStyle="#fff";J.lineWidth=2;J.beginPath();J.rect(a,b,c,c);J.stroke()};const Eb={0:"N",45:"NE",90:"E",135:"SE",180:"S",225:"SW",270:"W",315:"NW"};function Fb(){L("center");var a=J.createLinearGradient(R,S-100,R,S-50);a.addColorStop(0,"#fffe37");a.addColorStop(1,"#fe9400");J.fillStyle=a;J.fillRect(R-100,S-100,200,50);J.fillStyle="#000";J.font="bold 40px arial";J.fillText("ZingForce",R,S-60);a=J.createLinearGradient(R,S-50,R,S+50);a.addColorStop(0,"#fffe37");a.addColorStop(1,"#fe9400");J.fillStyle=a;J.font="bold 50px arial";J.fillText("WAR ZONE",R,S)}
function Gb(a){return Hb>R-50&&Hb<R+50&&Ib>S+a&&Ib<S+a+40}function Jb(a,b){J.fillStyle=Gb(b)?"#fffe37":"#fe9400";J.fillRect(R-50,S+b,100,40);T(a,R,S+b+27)}function Kb(a){J.fillStyle=Db(0,0,0,.5);J.fillRect(0,0,U,V);L("left");W(40);T(a,50,100);(a=ya(p,p.B))&&T("Rank #"+(a.H||1),50,150);{a=R-60;const b=S+50;J.fillStyle=Hb>a&&Hb<a+120&&Ib>b&&Ib<b+40?"#fffe37":"#fe9400";J.fillRect(a,b,120,40);L("center");W(16);T("EXIT",R,b+27)}}
function T(a,b,c){J.fillStyle="#000";J.fillText(a,b+1,c+1);J.fillStyle="#fff";J.fillText(a,b,c)}function Lb(a,b,c,e){J.strokeStyle="#000";J.beginPath();J.moveTo(a,b);J.lineTo(c,e);J.stroke();J.strokeStyle="#fff";J.beginPath();J.moveTo(a,b);J.lineTo(c,e);J.stroke()}function W(a){J.font=a+"px sans-serif"}function L(a){J.textAlign=a}
function Db(a,b,c,e){var d=6*a|0;var f=6*a-d;a=c*(1-b);var k=c*(1-f*b);b=c*(1-(1-f)*b);switch(d%6){case 0:var g=c;var h=b;var l=a;break;case 1:g=k;h=c;l=a;break;case 2:g=a;h=c;l=b;break;case 3:g=a;h=k;l=c;break;case 4:g=b;h=a;l=c;break;case 5:g=c,h=a,l=k}return"rgba("+(255*g|0)+","+(255*h|0)+","+(255*l|0)+","+(e||1)+")"};const Mb=io({upgrade:!1,transports:["websocket"]});let Nb=0,Ob=0,Pb=0;
Mb.on("update",function(a){var b=null===p||p.g!==a.g;p=a;if(b){K=new pa(p.i);b=y;var c=lb(b,b.VERTEX_SHADER,"\nattribute vec4 a;\nattribute vec2 b;\nuniform mat4 c;\nuniform mat4 d;\nvarying highp vec2 e;\nvoid main(void){\ngl_Position=d*c*a;\ne=b;\n}");var e=lb(b,b.FRAGMENT_SHADER,"\nvarying highp vec2 e;\nuniform sampler2D f;\nvoid main(void){\ngl_FragColor=texture2D(f,e);\nif(gl_FragColor.a<0.1)discard;\n}"),d=b.createProgram();b.attachShader(d,c);b.attachShader(d,e);b.linkProgram(d);c=d;Na={P:c,
G:{M:b.getAttribLocation(c,"a"),J:b.getAttribLocation(c,"b")},L:{O:b.getUniformLocation(c,"c"),R:b.getUniformLocation(c,"d")}};Qb=new Ha(35044);Rb=new Ha(35048);for(b=0;64>b;b++){e=b/64*m*2;d=(b+1)/64*m*2;c=1E3*Math.cos(e);e=1E3*Math.sin(e);var f=1E3*Math.cos(d),k=1E3*Math.sin(d);d=t(c,1E3,e);var g=t(f,1E3,k);f=t(f,0,k);c=t(c,0,e);Ja(Qb,[d,g,f,c],64,0)}b=t(-1E3,1E3,-1E3);c=t(1E3,1E3,-1E3);e=t(1E3,1E3,1E3);d=t(-1E3,1E3,1E3);Ja(Qb,[b,c,e,d],64,0,1);b=t(-1E3,0,-1E3);c=t(1E3,0,-1E3);e=t(1E3,0,1E3);d=
t(-1E3,0,1E3);Ja(Qb,[b,c,e,d],96,0);for(b=-400;400>b;b+=40)for(c=-400;400>c;c+=40)e=t(b,n(K,b,c),c),d=t(b+40,n(K,b+40,c),c),g=t(b+40,n(K,b+40,c+40),c+40),f=t(b,n(K,b,c+40),c+40),Ja(Qb,[e,d,g,f],80,0);for(b=0;b<K.i.length;b++)Sb(K.i[b].x,K.i[b].z,5,0,32);for(b=0;b<K.l.length;b++)Sb(K.l[b].x,K.l[b].z,1,32,16);Ka(Qb);Ka(Rb);xb=document.createElement("canvas");xb.width=1024;xb.height=1024;b=xb.getContext("2d");b.fillStyle="#163849";b.fillRect(0,0,1024,1024);c=1E4;e=0;for(d=-400;400>d;d+=40)for(g=-400;400>
g;g+=40)f=n(K,g,d),0<f&&(c=Math.min(c,f),e=Math.max(e,f));for(d=-400;400>d;d+=40)for(g=-400;400>g;g+=40){f=(n(K,g,d)+n(K,g+40,d)+n(K,g+40,d+40)+n(K,g,d+40))/4;if(0>=f)continue;k=(g- -500)/1E3*1024;const h=(500-d)/1E3*1024,l=(g+40- -500)/1E3*1024,q=(500-(d+40))/1E3*1024;b.fillStyle=Db(110/360,.4,Math.min(1,.4+.7*(f-c)/(e-c)));b.beginPath();b.rect(k,h,l-k,q-h);b.fill()}0===p.g?ub():wb()}if(b=a.F){for(c=0;c<b.length;c++)switch(d=b[c],d.A){case 13:d.u=8;Tb.push(d);d.l!==a.B&&pb(Math.hypot(d.x-x.x,d.z-
x.z));break;case 14:d.u=16;Tb.push(d);break;case 15:e=ya(p,d.v);(d=ya(p,d.l))?Ub.push(d.name+" killed "+e.name):Ub.push(e.name+" died outside the circle");break;case 16:d.l===a.B&&pb(0,.2)}b.length=0}a=Date.now();0<Nb&&(Ob=a-Nb,Pb=0<Pb?.1*Ob+.9*Pb:Ob);Nb=a;Mb.emit("update",x);x.actions=[]});const x=new ea(2,0,200,0,0,0,0);var Vb;{let a=localStorage.getItem("n");a||(a=da(),localStorage.setItem("n",a));Vb=a}x.name=Vb;x.m=.1;x.j=.1;x.actions=[];const Tb=[],Ub=[];let Na=null,Qb=null,Rb=null,Wb=!1,Xb=!1,U=2,V=2,R=1,S=1,Hb=0,Ib=0,p=null,K=null;const Yb=document.querySelectorAll("canvas"),Zb=Yb[0],X=Yb[1],J=X.getContext("2d");let $b=!1,ac=0;window.addEventListener("resize",bc,!1);bc();
X.addEventListener("click",function(a){if(0===a.button&&("undefined"!==typeof D&&"suspended"===D.state&&D.resume().then(()=>{console.log("Audio context resumed on user interaction")}),p))if(0===p.g){if(Gb(40)&&(cc(8),pb(0,.2)),Gb(100)){wb();if(a=prompt("Enter your name",x.name))localStorage.setItem("n",a),x.name=a;ub()}}else za()&&1!==wa(p)?Xb||(Wb?0<=p.currentTime&&za()&&dc():X.requestPointerLock()):ec()&&window.location.reload()});Mb.on("update",a=>{p=a});
function dc(){if(!p||za())cc(9),console.log("shoot"),pb(0),x.m-=.02*Math.random(),x.j+=.02*Math.random()-.01}function cc(a){{var b=w,c=fc,e=Ba,d=x.m;let f=[],k=[];f[0]=c[0]-e[0];f[1]=c[1]-e[1];f[2]=c[2]-e[2];k[0]=f[0];k[1]=f[1]*Math.cos(d)-f[2]*Math.sin(d);k[2]=f[1]*Math.sin(d)+f[2]*Math.cos(d);b[0]=k[0]+e[0];b[1]=k[1]+e[1];b[2]=k[2]+e[2]}Aa(w);x.actions.push(new ea(a,x.x,x.y,x.z,w[0],w[1],w[2]))}X.addEventListener("mousedown",function(a){2===a.button&&($b=!0)});
X.addEventListener("mouseup",function(a){2===a.button&&($b=!1)});function jb(){$b=!$b;console.log("Zoom toggled:",$b?"on":"off")}function ec(){const a=R-60,b=S+50;return Hb>a&&Hb<a+120&&Ib>b&&Ib<b+40}X.addEventListener("mousemove",function(a){Hb=a.pageX;Ib=a.pageY});document.addEventListener("pointerlockchange",gc);window.addEventListener("keydown",function(a){"f"!==a.key&&"F"!==a.key||dc()});
function hc(a){a*=.001;const b=a-ac;ac=a;if(K){for(let r=0;256>r;r++)B[r].g?B[r].h++:B[r].h=0;Aa(fc);x.h=0;x.i=0;if(B[38].g||B[87].g||B[90].g)x.h=8*w[0],x.i=8*w[2],x.g-=.02;if(B[40].g||B[83].g)x.h=-8*w[0],x.i=-8*w[2],x.g-=.02;if(B[37].g||B[65].g||B[81].g)x.h=-8*w[2],x.i=8*w[0],x.g-=.02;if(B[39].g||B[68].g)x.h=8*w[2],x.i=-8*w[0],x.g-=.02;if(1===B[77].h||Xb&&1===B[27].h)Xb=Xb?!1:!0;x.x+=b*x.h;x.z+=b*x.i;x.g-=20*b;x.y+=b*x.g;var c=n(K,x.x,x.z);x.y<c+1&&(x.g=0,x.y=c+1,1===B[32].h&&(x.g=6))}if(p&&0!==
p.g){Ia(Rb);p.s&&ic(p.s);ic(Tb);if(0<=p.currentTime){{let r=p.currentTime,C=va(K,r);for(let Z=0;64>Z;Z++){const qa=Z/64*m*2,Y=(Z+1)/64*m*2,Da=C.x+C.g*Math.cos(qa),ca=C.z+C.g*Math.sin(qa),nc=C.x+C.g*Math.cos(Y),oc=C.z+C.g*Math.sin(Y),Xc=t(Da,400,ca),Yc=t(nc,400,oc),Zc=t(nc,0,oc),$c=t(Da,0,ca);Ja(Rb,[Xc,Yc,Zc,$c],((5*r|0)+Z)%4*32,64,32,64)}}}La(Rb,y);var e=y;e.clearColor(0,0,0,1);e.clearDepth(1);e.enable(2929);e.depthFunc(515);e.enable(3042);e.blendFunc(770,771);e.clear(16640);y.viewport(0,0,U,V);var d=
Pa,f=1/Math.tan(($b?10:60)*m/180/2),k=1/-3999.9;d[0]=f/(U/V);d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=f;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=4000.1*k;d[11]=-1;d[12]=0;d[13]=0;d[14]=800*k;d[15]=0;Fa(jc);var g=jc,h=jc,l=x.m,q=Math.sin(l),v=Math.cos(l),aa=h[4],ra=h[5],sa=h[6],pc=h[7],qc=h[8],rc=h[9],sc=h[10],tc=h[11];h!==g&&(g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g[12]=h[12],g[13]=h[13],g[14]=h[14],g[15]=h[15]);g[4]=aa*v+qc*q;g[5]=ra*v+rc*q;g[6]=sa*v+sc*q;g[7]=pc*v+tc*q;g[8]=qc*v-aa*q;g[9]=rc*v-ra*q;g[10]=sc*
v-sa*q;g[11]=tc*v-pc*q;Fa(kc);Ga(kc,kc,x.j);var M=Qa,N=jc,O=kc,Ra=N[0],Sa=N[1],Ta=N[2],Ua=N[3],Va=N[4],Wa=N[5],Xa=N[6],Ya=N[7],Za=N[8],$a=N[9],ab=N[10],bb=N[11],cb=N[12],db=N[13],eb=N[14],fb=N[15],E=O[0],F=O[1],G=O[2],H=O[3];M[0]=E*Ra+F*Va+G*Za+H*cb;M[1]=E*Sa+F*Wa+G*$a+H*db;M[2]=E*Ta+F*Xa+G*ab+H*eb;M[3]=E*Ua+F*Ya+G*bb+H*fb;E=O[4];F=O[5];G=O[6];H=O[7];M[4]=E*Ra+F*Va+G*Za+H*cb;M[5]=E*Sa+F*Wa+G*$a+H*db;M[6]=E*Ta+F*Xa+G*ab+H*eb;M[7]=E*Ua+F*Ya+G*bb+H*fb;E=O[8];F=O[9];G=O[10];H=O[11];M[8]=E*Ra+F*Va+G*Za+
H*cb;M[9]=E*Sa+F*Wa+G*$a+H*db;M[10]=E*Ta+F*Xa+G*ab+H*eb;M[11]=E*Ua+F*Ya+G*bb+H*fb;E=O[12];F=O[13];G=O[14];H=O[15];M[12]=E*Ra+F*Va+G*Za+H*cb;M[13]=E*Sa+F*Wa+G*$a+H*db;M[14]=E*Ta+F*Xa+G*ab+H*eb;M[15]=E*Ua+F*Ya+G*bb+H*fb;Ga(Qa,Qa,m);var P=Qa,Q=Qa,yb=lc,gb=yb[0],hb=yb[1],ib=yb[2];P[0]=Q[0]*gb;P[1]=Q[1]*gb;P[2]=Q[2]*gb;P[3]=Q[3]*gb;P[4]=Q[4]*hb;P[5]=Q[5]*hb;P[6]=Q[6]*hb;P[7]=Q[7]*hb;P[8]=Q[8]*ib;P[9]=Q[9]*ib;P[10]=Q[10]*ib;P[11]=Q[11]*ib;P[12]=Q[12];P[13]=Q[13];P[14]=Q[14];P[15]=Q[15];mc[0]=-x.x;mc[1]=
-x.y-.5;mc[2]=-x.z;var A=Qa,u=Qa,zb=mc,ia=zb[0],ja=zb[1],ka=zb[2];if(u===A)A[12]=u[0]*ia+u[4]*ja+u[8]*ka+u[12],A[13]=u[1]*ia+u[5]*ja+u[9]*ka+u[13],A[14]=u[2]*ia+u[6]*ja+u[10]*ka+u[14],A[15]=u[3]*ia+u[7]*ja+u[11]*ka+u[15];else{var uc=u[0];var vc=u[1];var wc=u[2];var xc=u[3];var yc=u[4];var zc=u[5];var Ac=u[6];var Bc=u[7];var Cc=u[8];var Dc=u[9];var Ec=u[10];var Fc=u[11];A[0]=uc;A[1]=vc;A[2]=wc;A[3]=xc;A[4]=yc;A[5]=zc;A[6]=Ac;A[7]=Bc;A[8]=Cc;A[9]=Dc;A[10]=Ec;A[11]=Fc;A[12]=uc*ia+yc*ja+Cc*ka+u[12];A[13]=
vc*ia+zc*ja+Dc*ka+u[13];A[14]=wc*ia+Ac*ja+Ec*ka+u[14];A[15]=xc*ia+Bc*ja+Fc*ka+u[15]}Ma(Qb);Ma(Rb)}J.clearRect(0,0,X.width,X.height);if(p)if(0===p.g)Fb(),W(20),L("center"),Jb("JOIN",40),Jb("NAME",100);else if(za())if(1===wa(p))Kb("WINNER WINNER CHICKEN DINNER");else{if(0<=p.currentTime){let r=va(K,p.currentTime),C=ya(p,p.B);r&&C&&oa(r,C)&&(J.fillStyle=Db(0,1,1,.5),J.fillRect(0,0,U,V))}if(Xb){const r=.9*V|0;Cb(R-r/2|0,S-r/2|0,r,!0)}else{{const r=(180*x.j/m+.5|0)-90,C=U/3,Z=U/3/180;L("center");for(let qa=
0,Y=r,Da=C;180>=qa;qa++,Y++,Da+=Z){const ca=Da+.5|0;for(var Ea=Y;0>Ea;)Ea+=360;for(;360<=Ea;)Ea-=360;Y=Ea;0===Y%15&&(Eb[Y]?(W(14),J.lineWidth=2,Lb(ca,30,ca,40),T(Eb[Y],ca,60)):(W(11),J.lineWidth=1,Lb(ca,32,ca,38),T(Y.toString(),ca,60)))}}W(18);J.fillStyle="#000";J.fillRect(U-130,20,40,30);L("center");var bd=wa(p),cd=U-110;J.fillStyle="#fff";J.fillText(bd,cd,42);J.fillStyle="#888";J.fillRect(U-90,20,80,30);L("left");var dd=U-85;J.fillStyle="#444";J.fillText("ALIVE",dd,42);{const r=ya(p,p.B);r&&(W(24),
L("center"),T("Ammo: "+r.D,R,V-65))}{const r=ya(p,p.B);if(r){var Gc=R-200,Hc=V-50,Ab=r.o/100;J.fillStyle=Db(0,1-Ab,.5+.5*Ab);J.fillRect(Gc,Hc,400*Ab,25);J.strokeStyle="#fff";J.lineWidth=1;J.beginPath();J.rect(Gc,Hc,400,25);J.stroke()}}{const r=.15*X.width|0,C=X.width-r-20|0,Z=X.height-r-20|0;Cb(C,Z,r,!1);if(p&&0<=p.currentTime){const qa=Z-10,Y=30-(p.currentTime|0)%30;W(14);L("left");T(Y,C,qa)}}L("left");W(11);T("WASD - Move",20,V-140);T("Left click - Shoot",20,V-120);T("Right click - Zoom",20,V-100);
T("M - Map",20,V-80);if(0<=p.currentTime){J.lineWidth=2;Lb(R-30,S,R+30,S);Lb(R,S-30,R,S+30);{let r=(p.currentTime|0)%60,C=.25*V|0;W(40);L("center");5>r?T("New Play Area marked on map",R,C):20<=r&&25>r?T("Old Play Area goes OFFLINE in 10s!",R,C):30<=r&&35>r&&T("Old Play Area going OFFLINE!",R,C)}}else!p||0<=p.currentTime||(L("center"),W(14),T("Starts in:",R,S-60),W(60),console.log(-p.currentTime),T(-p.currentTime|0,R,S));W(11);L("right");for(let r=0;r<Ub.length;r++)T(Ub[r],U-10,80+20*r)}W(11);L("center");
T("Ping "+Pb.toFixed(0)+" ms",R,V-10)}else Kb("YOU DIED");else Fb(),W(11),L("center"),T("Connecting...",R,S+50);requestAnimationFrame(hc)}requestAnimationFrame(hc);function bc(){U=window.innerWidth;V=window.innerHeight;R=U/2|0;S=V/2|0;Zb&&(Zb.width=U,Zb.height=V);X&&(X.width=U,X.height=V)}function gc(){document.pointerLockElement===X||document.mozPointerLockElement===X?(document.addEventListener("mousemove",Ic,!1),Wb=!0):(document.removeEventListener("mousemove",Ic,!1),Wb=!1)}
function Ic(a){const b=$b?1E-4:.001;x.j=xa(x.j+b*a.movementX);x.m=xa(x.m+b*a.movementY)};const Ba=new Float32Array(3),fc=t(0,0,1),w=new Float32Array(3),mc=new Float32Array(3),lc=t(-1,1,1),Pa=Ca(),Qa=Ca(),jc=Ca(),kc=Ca(),y=Zb.getContext("webgl",{alpha:!1,antialias:!1,premultipliedAlpha:!1}),Oa=Jc();
function Jc(){const a=y.createTexture();y.bindTexture(3553,a);y.texImage2D(3553,0,6408,1,1,0,6408,5121,new Uint8Array([0,0,255,255]));const b=new Image;b.onload=function(){y.bindTexture(3553,a);y.texImage2D(3553,0,6408,6408,5121,b);y.texParameteri(3553,10240,9728);y.texParameteri(3553,10241,9728);y.generateMipmap(3553)};b.src="textures.png";return a}
function Sb(a,b,c,e,d){var f=Qb;const k=n(K,a,b)+c;{var g=t(a-c,k+c,b),h=t(a+c,k+c,b),l=t(a+c,k-c,b);const q=t(a-c,k-c,b);Ja(f,[g,h,l,q],e,0,d)}g=t(a,k+c,b-c);h=t(a,k+c,b+c);l=t(a,k-c,b+c);a=t(a,k-c,b-c);Ja(f,[g,h,l,a],e,0,d)}
function ic(a){for(let k=a.length-1;0<=k;k--){let g=a[k];if(!(0>=g.o||g.v===p.B)){switch(g.A){case 2:{var b=(5*(30+p.currentTime)|0)%4;3===b&&(b=1);var c=.001<Math.hypot(g.h,g.i),e=g.x-x.x;let h=g.z-x.z;var d=Math.hypot(e,h);let l=0;var f=0;0<d&&(e/=d,h/=d,f=Math.sin(g.j),d=Math.cos(g.j),l=e*f+h*d,f=e*d-h*f);e=!1;.7<l?c?(b=48+16*b,c=48):c=b=32:-.7>l?(b=c?48+16*b:0,c=32):(c?(b*=16,c=48):(b=16,c=32),e=0>f);Kc(g,1,b,c,e)}break;case 3:Kc(g,.05,48,0);break;case 13:Kc(g,.04,112,16);g.u-=4;break;case 14:Kc(g,
.5,32+16*Math.min(3,(16-g.u)/4|0),16);g.u--;break;case 6:Kc(g,.5,96,16);break;case 7:Kc(g,.5,112,0)}2!==g.A&&0===g.u&&a.splice(k,1)}}}function Kc(a,b,c,e,d){var f=a.x,k=a.y;a=a.z;var g=f-x.x,h=a-x.z,l=Math.hypot(g,h);g/=l;h/=l;l=d?-1:1;d=f-l*b*h;h=f+l*b*h;f=a+l*b*g;a-=l*b*g;g=k+b;k-=b;b=t(d,g,f);g=t(h,g,a);a=t(h,k,a);k=t(d,k,f);Ja(Rb,[b,g,a,k],c,e)};
