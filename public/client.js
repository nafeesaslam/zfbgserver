'use strict';function ya(a){for(;a>m;)a-=2*m;for(;a<-m;)a+=2*m;return a}function Aa(a,b){for(let c=0;c<a.s.length;c++){let e=a.s[c];if(e.v===b)return e}return null}function Ba(){var a=q;return(a=Aa(a,a.B))&&0<a.o}function r(a,b,c){let e=new Float32Array(3);e[0]=a;e[1]=b;e[2]=c;return e}
function Ca(a){var b=w,c=Da,e=x.j;let d=[],f=[];d[0]=a[0]-c[0];d[1]=a[1]-c[1];d[2]=a[2]-c[2];f[0]=d[2]*Math.sin(e)+d[0]*Math.cos(e);f[1]=d[1];f[2]=d[2]*Math.cos(e)-d[0]*Math.sin(e);b[0]=f[0]+c[0];b[1]=f[1]+c[1];b[2]=f[2]+c[2]};function Ga(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function Ha(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1}
function Ia(a,b,c){var e=Math.sin(c);c=Math.cos(c);var d=b[0],f=b[1],h=b[2],g=b[3],k=b[8],l=b[9],p=b[10],v=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=d*c-k*e;a[1]=f*c-l*e;a[2]=h*c-p*e;a[3]=g*c-v*e;a[8]=d*e+k*c;a[9]=f*e+l*c;a[10]=h*e+p*c;a[11]=g*e+v*c};function Ja(a){this.usage=a;this.C=new Float32Array(65536);this.g=new Float32Array(65536);this.i=new Uint16Array(65536);Ka(this)}function Ka(a){a.K=0;a.S=0;a.h=0;a.j=0}
function La(a,b,c,e,d,f){const h=a.K;for(var g=0;4>g;g++){for(var k=0;3>k;k++)a.C[a.S++]=b[g][k];a.K++}g=d||16;b=c/128;d=e/128;c=(c+g)/128;e=(e+(f||g))/128;a.g[a.h++]=b;a.g[a.h++]=d;a.g[a.h++]=c;a.g[a.h++]=d;a.g[a.h++]=c;a.g[a.h++]=e;a.g[a.h++]=b;a.g[a.h++]=e;a.i[a.j++]=h;a.i[a.j++]=h+1;a.i[a.j++]=h+2;a.i[a.j++]=h;a.i[a.j++]=h+2;a.i[a.j++]=h+3}function Ma(a){var b=y;a.m=b.createBuffer();a.I=b.createBuffer();a.l=b.createBuffer();Na(a,b)}
function Na(a,b){b.bindBuffer(34962,a.m);b.bufferData(34962,a.C,a.usage);b.bindBuffer(34962,a.I);b.bufferData(34962,a.g,a.usage);b.bindBuffer(34963,a.l);b.bufferData(34963,a.i,a.usage)}
function Oa(a){var b=y,c=Pa,e=Qa;b.bindBuffer(34962,a.m);b.vertexAttribPointer(c.G.M,3,5126,!1,0,0);b.enableVertexAttribArray(c.G.M);b.bindBuffer(34962,a.I);b.vertexAttribPointer(c.G.J,2,5126,!1,0,0);b.enableVertexAttribArray(c.G.J);b.bindBuffer(34963,a.l);b.useProgram(c.P);b.uniformMatrix4fv(c.L.R,!1,Ta);b.uniformMatrix4fv(c.L.O,!1,Ua);b.activeTexture(33984);b.bindTexture(3553,e);b.drawElements(4,a.j,5123,0)}
window.addEventListener("message",a=>{"moveLeftDown"===a.data.action&&z(65,!0);"moveLeftUp"===a.data.action&&z(65,!1);"moveRightDown"===a.data.action&&z(68,!0);"moveRightUp"===a.data.action&&z(68,!1);"moveUpDown"===a.data.action&&z(87,!0);"moveUpUp"===a.data.action&&z(87,!1);"moveDownDown"===a.data.action&&z(83,!0);"moveDownUp"===a.data.action&&z(83,!1);"jumpDown"===a.data.action&&z(32,!0);"jumpUp"===a.data.action&&z(32,!1);if("fireStart"===a.data.action){var b=new KeyboardEvent("keydown",{key:"f",
keyCode:70,which:70,bubbles:!0});window.dispatchEvent(b)}"fireStop"===a.data.action&&(b=new KeyboardEvent("keyup",{key:"f",keyCode:70,which:70,bubbles:!0}),window.dispatchEvent(b));"pointerLockChange"===a.data.action&&(b=new PointerEvent("pointerlockchange",{bubbles:!0}),window.dispatchEvent(b));"zoomToggle"===a.data.action&&("function"===typeof nb&&nb(),console.log("BufferSet: Zoom toggle from iframe"));"zoomOut"===a.data.action&&(a=new WheelEvent("wheel",{deltaY:100,bubbles:!0}),document.dispatchEvent(a),
console.log("BufferSet: Zoom reset from iframe"))});function ob(){this.g=!1;this.h=0}const C=Array(256);for(let a=0;256>a;a++)C[a]=new ob;document.addEventListener("keydown",function(a){console.log("keydown",a.keyCode);z(a.keyCode,!0)});document.addEventListener("keyup",function(a){z(a.keyCode,!1)});function z(a,b){0<=a&&256>a&&(C[a].g=b)};function pb(a,b,c){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return b};const H=new AudioContext,qb=H.sampleRate,rb=H.createBuffer(1,qb,qb),sb=rb.getChannelData(0);for(let a=0;a<qb;a++)sb[a]=2*Math.random()-1;
function tb(a,b){if(!(500<a)){var c=b||1;b=1-a/500;var e=b*b,d=1E3-a;b=5E3-10*a;a=Math.max(1,10-a/50);var f=H.currentTime,h=H.createGain();h.gain.value=0;h.gain.setValueAtTime(10*e,f);h.gain.exponentialRampToValueAtTime(.001,f+.7*c);h.gain.setValueAtTime(0,f+c);h.connect(H.destination);c=H.createBiquadFilter();c.type="lowpass";c.Q.value=1;c.frequency.value=d;c.connect(h);d=H.createBiquadFilter();d.type="lowshelf";d.frequency.value=b;d.gain.value=a;d.connect(c);b=H.createBufferSource();b.buffer=rb;
b.connect(d);b.start()}}const ub=H.createGain();ub.connect(H.destination);ub.gain.setTargetAtTime(.04,0,.01);let vb=null,wb=null;function xb(a){return new Promise((b,c)=>{const e=new XMLHttpRequest;e.open("GET",a,!0);e.responseType="arraybuffer";e.onload=function(){200===e.status?H.decodeAudioData(e.response,function(d){b(d)},function(d){c(d)}):c(Error("Failed to load music file: "+e.status))};e.onerror=function(){c(Error("Failed to load music file"))};e.send()})}
function yb(){wb?"suspended"===H.state?(console.log("Audio context suspended, attempting to resume..."),H.resume().then(()=>{console.log("Audio context resumed successfully");zb()}).catch(a=>{console.error("Failed to resume audio context:",a)})):zb():console.warn("No music buffer loaded")}function zb(){Ab();vb=H.createBufferSource();vb.buffer=wb;vb.loop=!0;vb.connect(ub);vb.start();console.log("Music started playing")}function Ab(){vb&&(vb.stop(),vb=null)}
(function(a){xb(a).then(function(b){wb=b;console.log("Music loaded successfully")}).catch(function(b){console.error("Failed to load music:",b)})})("/battleThemeA.mp3");let Bb=null,Hb=document.createElement("canvas");Hb.width=1024;Hb.height=1024;let I=Hb.getContext("2d");const Ib={0:"N",45:"NE",90:"E",135:"SE",180:"S",225:"SW",270:"W",315:"NW"};function Jb(){O("center");var a=P.createLinearGradient(Q,R-100,Q,R-50);a.addColorStop(0,"#fffe37");a.addColorStop(1,"#fe9400");P.fillStyle=a;P.fillRect(Q-100,R-100,200,50);P.fillStyle="#000";P.font="bold 40px arial";P.fillText("ZingForce",Q,R-60);a=P.createLinearGradient(Q,R-50,Q,R+50);a.addColorStop(0,"#fffe37");a.addColorStop(1,"#fe9400");P.fillStyle=a;P.font="bold 50px arial";P.fillText("WAR ZONE",Q,R)}
function Kb(a){return Lb>Q-50&&Lb<Q+50&&Mb>R+a&&Mb<R+a+40}function Nb(a,b){P.fillStyle=Kb(b)?"#fffe37":"#fe9400";P.fillRect(Q-50,R+b,100,40);S(a,Q,R+b+27)}function Ob(a){P.fillStyle=Pb(0,0,0,.5);P.fillRect(0,0,T,U);O("left");X(40);S(a,50,100);(a=Aa(q,q.B))&&S("Rank #"+(a.H||1),50,150);{a=Q-60;const b=R+50;P.fillStyle=Lb>a&&Lb<a+120&&Mb>b&&Mb<b+40?"#fffe37":"#fe9400";P.fillRect(a,b,120,40);O("center");X(16);S("EXIT",Q,b+27)}}
function S(a,b,c){P.fillStyle="#000";P.fillText(a,b+1,c+1);P.fillStyle="#fff";P.fillText(a,b,c)}function Qb(a,b,c,e){P.strokeStyle="#000";P.beginPath();P.moveTo(a,b);P.lineTo(c,e);P.stroke();P.strokeStyle="#fff";P.beginPath();P.moveTo(a,b);P.lineTo(c,e);P.stroke()}function X(a){P.font=a+"px sans-serif"}function O(a){P.textAlign=a}
function Pb(a,b,c,e){var d=6*a|0;var f=6*a-d;a=c*(1-b);var h=c*(1-f*b);b=c*(1-(1-f)*b);switch(d%6){case 0:var g=c;var k=b;var l=a;break;case 1:g=h;k=c;l=a;break;case 2:g=a;k=c;l=b;break;case 3:g=a;k=h;l=c;break;case 4:g=b;k=a;l=c;break;case 5:g=c,k=a,l=h}return"rgba("+(255*g|0)+","+(255*k|0)+","+(255*l|0)+","+(e||1)+")"};const Rb=io({upgrade:!1,transports:["websocket"]});let Sb=0,Tb=0,Ub=0;
Rb.on("update",function(a){var b=null===q||q.g!==a.g;q=a;if(b){Y=new qa(q.i);b=y;var c=pb(b,b.VERTEX_SHADER,"\nattribute vec4 a;\nattribute vec2 b;\nuniform mat4 c;\nuniform mat4 d;\nvarying highp vec2 e;\nvoid main(void){\ngl_Position=d*c*a;\ne=b;\n}");var e=pb(b,b.FRAGMENT_SHADER,"\nvarying highp vec2 e;\nuniform sampler2D f;\nvoid main(void){\ngl_FragColor=texture2D(f,e);\nif(gl_FragColor.a<0.1)discard;\n}"),d=b.createProgram();b.attachShader(d,c);b.attachShader(d,e);b.linkProgram(d);c=d;Pa={P:c,
G:{M:b.getAttribLocation(c,"a"),J:b.getAttribLocation(c,"b")},L:{O:b.getUniformLocation(c,"c"),R:b.getUniformLocation(c,"d")}};Vb=new Ja(35044);Wb=new Ja(35048);for(b=0;64>b;b++){e=b/64*m*2;d=(b+1)/64*m*2;c=1E3*Math.cos(e);e=1E3*Math.sin(e);var f=1E3*Math.cos(d),h=1E3*Math.sin(d);d=r(c,1E3,e);var g=r(f,1E3,h);f=r(f,0,h);c=r(c,0,e);La(Vb,[d,g,f,c],64,0)}b=r(-1E3,1E3,-1E3);c=r(1E3,1E3,-1E3);e=r(1E3,1E3,1E3);d=r(-1E3,1E3,1E3);La(Vb,[b,c,e,d],64,0,1);b=r(-1E3,0,-1E3);c=r(1E3,0,-1E3);e=r(1E3,0,1E3);d=
r(-1E3,0,1E3);La(Vb,[b,c,e,d],96,0);for(b=-400;400>b;b+=40)for(c=-400;400>c;c+=40)e=r(b,n(Y,b,c),c),d=r(b+40,n(Y,b+40,c),c),g=r(b+40,n(Y,b+40,c+40),c+40),f=r(b,n(Y,b,c+40),c+40),La(Vb,[e,d,g,f],80,0);for(b=0;b<Y.i.length;b++)Xb(Y.i[b].x,Y.i[b].z,5,0,32);for(b=0;b<Y.l.length;b++)Xb(Y.l[b].x,Y.l[b].z,1,32,16);Ma(Vb);Ma(Wb);Bb=document.createElement("canvas");Bb.width=1024;Bb.height=1024;b=Bb.getContext("2d");b.fillStyle="#163849";b.fillRect(0,0,1024,1024);c=1E4;e=0;for(d=-400;400>d;d+=40)for(g=-400;400>
g;g+=40)f=n(Y,g,d),0<f&&(c=Math.min(c,f),e=Math.max(e,f));for(d=-400;400>d;d+=40)for(g=-400;400>g;g+=40){f=(n(Y,g,d)+n(Y,g+40,d)+n(Y,g+40,d+40)+n(Y,g,d+40))/4;if(0>=f)continue;h=(g- -500)/1E3*1024;const k=(500-d)/1E3*1024,l=(g+40- -500)/1E3*1024,p=(500-(d+40))/1E3*1024;b.fillStyle=Pb(110/360,.4,Math.min(1,.4+.7*(f-c)/(e-c)));b.beginPath();b.rect(h,k,l-h,p-k);b.fill()}0===q.g?yb():Ab()}if(b=a.F){for(c=0;c<b.length;c++)switch(d=b[c],d.A){case 13:d.u=8;Yb.push(d);d.l!==a.B&&tb(Math.hypot(d.x-x.x,d.z-
x.z));break;case 14:d.u=16;Yb.push(d);break;case 15:e=Aa(q,d.v);(d=Aa(q,d.l))?Zb.push(d.name+" killed "+e.name):Zb.push(e.name+" died outside the circle");break;case 16:d.l===a.B&&tb(0,.2)}b.length=0}a=Date.now();0<Sb&&(Tb=a-Sb,Ub=0<Ub?.1*Tb+.9*Ub:Tb);Sb=a;Rb.emit("update",x);x.actions=[]});const x=new fa(2,0,200,0,0,0,0);var $b;{let a=localStorage.getItem("n");a||(a=ea(),localStorage.setItem("n",a));$b=a}x.name=$b;x.m=.1;x.j=.1;x.actions=[];const Yb=[],Zb=[];let Pa=null,Vb=null,Wb=null,ac=!1,bc=!1,T=2,U=2,Q=1,R=1,Lb=0,Mb=0,q=null,Y=null;const cc=document.querySelectorAll("canvas"),dc=cc[0],Z=cc[1],P=Z.getContext("2d");let ec=!1,fc=0;window.addEventListener("resize",gc,!1);gc();
Z.addEventListener("click",function(a){if(0===a.button&&("undefined"!==typeof H&&"suspended"===H.state&&H.resume().then(()=>{console.log("Audio context resumed on user interaction")}),q))if(0===q.g){if(Kb(40)&&(hc(8),tb(0,.2)),Kb(100)){Ab();if(a=prompt("Enter your name",x.name))localStorage.setItem("n",a),x.name=a;yb()}}else Ba()&&1!==xa(q)?bc||(ac?0<=q.currentTime&&Ba()&&ic():Z.requestPointerLock()):jc()&&window.location.reload()});Rb.on("update",a=>{q=a});
function ic(){if(!q||Ba())hc(9),console.log("shoot"),tb(0),x.m-=.02*Math.random(),x.j+=.02*Math.random()-.01}function hc(a){{var b=w,c=kc,e=Da,d=x.m;let f=[],h=[];f[0]=c[0]-e[0];f[1]=c[1]-e[1];f[2]=c[2]-e[2];h[0]=f[0];h[1]=f[1]*Math.cos(d)-f[2]*Math.sin(d);h[2]=f[1]*Math.sin(d)+f[2]*Math.cos(d);b[0]=h[0]+e[0];b[1]=h[1]+e[1];b[2]=h[2]+e[2]}Ca(w);x.actions.push(new fa(a,x.x,x.y,x.z,w[0],w[1],w[2]))}Z.addEventListener("mousedown",function(a){2===a.button&&(ec=!0)});
Z.addEventListener("mouseup",function(a){2===a.button&&(ec=!1)});function nb(){ec=!ec;console.log("Zoom toggled:",ec?"on":"off")}function jc(){const a=Q-60,b=R+50;return Lb>a&&Lb<a+120&&Mb>b&&Mb<b+40}Z.addEventListener("mousemove",function(a){Lb=a.pageX;Mb=a.pageY});document.addEventListener("pointerlockchange",lc);window.addEventListener("keydown",function(a){"f"!==a.key&&"F"!==a.key||ic()});
function mc(a){a*=.001;const b=a-fc;fc=a;if(Y){for(let t=0;256>t;t++)C[t].g?C[t].h++:C[t].h=0;Ca(kc);x.h=0;x.i=0;if(C[38].g||C[87].g||C[90].g)x.h=8*w[0],x.i=8*w[2],x.g-=.02;if(C[40].g||C[83].g)x.h=-8*w[0],x.i=-8*w[2],x.g-=.02;if(C[37].g||C[65].g||C[81].g)x.h=-8*w[2],x.i=8*w[0],x.g-=.02;if(C[39].g||C[68].g)x.h=8*w[2],x.i=-8*w[0],x.g-=.02;if(1===C[77].h||bc&&1===C[27].h)bc=bc?!1:!0;x.x+=b*x.h;x.z+=b*x.i;x.g-=20*b;x.y+=b*x.g;var c=n(Y,x.x,x.z);x.y<c+1&&(x.g=0,x.y=c+1,1===C[32].h&&(x.g=6))}if(q&&0!==
q.g){Ka(Wb);q.s&&nc(q.s);nc(Yb);if(0<=q.currentTime){{let t=q.currentTime,A=wa(Y,t);for(let aa=0;64>aa;aa++){const da=aa/64*m*2,V=(aa+1)/64*m*2,ra=A.x+A.g*Math.cos(da),W=A.z+A.g*Math.sin(da),Ra=A.x+A.g*Math.cos(V),Ea=A.z+A.g*Math.sin(V),Sa=r(ra,400,W),$c=r(Ra,400,Ea),ad=r(Ra,0,Ea),bd=r(ra,0,W);La(Wb,[Sa,$c,ad,bd],((5*t|0)+aa)%4*32,64,32,64)}}}Na(Wb,y);var e=y;e.clearColor(0,0,0,1);e.clearDepth(1);e.enable(2929);e.depthFunc(515);e.enable(3042);e.blendFunc(770,771);e.clear(16640);y.viewport(0,0,T,U);
var d=Ta,f=1/Math.tan((ec?10:60)*m/180/2),h=1/-3999.9;d[0]=f/(T/U);d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=f;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=4000.1*h;d[11]=-1;d[12]=0;d[13]=0;d[14]=800*h;d[15]=0;Ha(oc);var g=oc,k=oc,l=x.m,p=Math.sin(l),v=Math.cos(l),ba=k[4],sa=k[5],ta=k[6],sc=k[7],tc=k[8],uc=k[9],vc=k[10],wc=k[11];k!==g&&(g[0]=k[0],g[1]=k[1],g[2]=k[2],g[3]=k[3],g[12]=k[12],g[13]=k[13],g[14]=k[14],g[15]=k[15]);g[4]=ba*v+tc*p;g[5]=sa*v+uc*p;g[6]=ta*v+vc*p;g[7]=sc*v+wc*p;g[8]=tc*v-ba*p;g[9]=uc*v-sa*p;g[10]=
vc*v-ta*p;g[11]=wc*v-sc*p;Ha(pc);Ia(pc,pc,x.j);var J=Ua,K=oc,L=pc,Va=K[0],Wa=K[1],Xa=K[2],Ya=K[3],Za=K[4],$a=K[5],ab=K[6],bb=K[7],cb=K[8],db=K[9],eb=K[10],fb=K[11],gb=K[12],hb=K[13],ib=K[14],jb=K[15],D=L[0],E=L[1],F=L[2],G=L[3];J[0]=D*Va+E*Za+F*cb+G*gb;J[1]=D*Wa+E*$a+F*db+G*hb;J[2]=D*Xa+E*ab+F*eb+G*ib;J[3]=D*Ya+E*bb+F*fb+G*jb;D=L[4];E=L[5];F=L[6];G=L[7];J[4]=D*Va+E*Za+F*cb+G*gb;J[5]=D*Wa+E*$a+F*db+G*hb;J[6]=D*Xa+E*ab+F*eb+G*ib;J[7]=D*Ya+E*bb+F*fb+G*jb;D=L[8];E=L[9];F=L[10];G=L[11];J[8]=D*Va+E*Za+
F*cb+G*gb;J[9]=D*Wa+E*$a+F*db+G*hb;J[10]=D*Xa+E*ab+F*eb+G*ib;J[11]=D*Ya+E*bb+F*fb+G*jb;D=L[12];E=L[13];F=L[14];G=L[15];J[12]=D*Va+E*Za+F*cb+G*gb;J[13]=D*Wa+E*$a+F*db+G*hb;J[14]=D*Xa+E*ab+F*eb+G*ib;J[15]=D*Ya+E*bb+F*fb+G*jb;Ia(Ua,Ua,m);var M=Ua,N=Ua,Cb=qc,kb=Cb[0],lb=Cb[1],mb=Cb[2];M[0]=N[0]*kb;M[1]=N[1]*kb;M[2]=N[2]*kb;M[3]=N[3]*kb;M[4]=N[4]*lb;M[5]=N[5]*lb;M[6]=N[6]*lb;M[7]=N[7]*lb;M[8]=N[8]*mb;M[9]=N[9]*mb;M[10]=N[10]*mb;M[11]=N[11]*mb;M[12]=N[12];M[13]=N[13];M[14]=N[14];M[15]=N[15];rc[0]=-x.x;
rc[1]=-x.y-.5;rc[2]=-x.z;var B=Ua,u=Ua,Db=rc,ja=Db[0],ka=Db[1],la=Db[2];if(u===B)B[12]=u[0]*ja+u[4]*ka+u[8]*la+u[12],B[13]=u[1]*ja+u[5]*ka+u[9]*la+u[13],B[14]=u[2]*ja+u[6]*ka+u[10]*la+u[14],B[15]=u[3]*ja+u[7]*ka+u[11]*la+u[15];else{var xc=u[0];var yc=u[1];var zc=u[2];var Ac=u[3];var Bc=u[4];var Cc=u[5];var Dc=u[6];var Ec=u[7];var Fc=u[8];var Gc=u[9];var Hc=u[10];var Ic=u[11];B[0]=xc;B[1]=yc;B[2]=zc;B[3]=Ac;B[4]=Bc;B[5]=Cc;B[6]=Dc;B[7]=Ec;B[8]=Fc;B[9]=Gc;B[10]=Hc;B[11]=Ic;B[12]=xc*ja+Bc*ka+Fc*la+u[12];
B[13]=yc*ja+Cc*ka+Gc*la+u[13];B[14]=zc*ja+Dc*ka+Hc*la+u[14];B[15]=Ac*ja+Ec*ka+Ic*la+u[15]}Oa(Vb);Oa(Wb)}P.clearRect(0,0,Z.width,Z.height);if(q)if(0===q.g)Jb(),X(20),O("center"),Nb("JOIN",40),Nb("NAME",100);else if(Ba())if(1===xa(q))Ob("WINNER WINNER CHICKEN DINNER");else{if(0<=q.currentTime){let t=wa(Y,q.currentTime),A=Aa(q,q.B);t&&A&&pa(t,A)&&(P.fillStyle=Pb(0,1,1,.5),P.fillRect(0,0,T,U))}if(bc){const t=.9*U|0;var Eb=Q-t/2|0,Fb=R-t/2|0,za=t;P.fillStyle="#323e30";P.fillRect(Eb,Fb,za,za);if(Bb){I.drawImage(Bb,
0,0,1024,1024,0,0,1024,1024);const A=(x.x- -500)/1E3*1024,aa=(500-x.z)/1E3*1024;let da=q.currentTime;if(0<da){let V=wa(Y,da),ra=V.g/1E3*1024;I.fillStyle=Pb(.66,1,1,.5);I.beginPath();I.arc((V.x- -500)/1E3*1024,(500-V.z)/1E3*1024,ra,0,2*m);I.rect(1024,0,-1024,1024);I.fill();let W=va(Y,da),Ra=W.g/1E3*1024,Ea=(W.x- -500)/1E3*1024,Sa=(500-W.z)/1E3*1024;I.strokeStyle="#fff";I.beginPath();I.arc(Ea,Sa,Ra,0,2*m);I.rect(1024,0,-1024,1024);I.lineWidth=2;I.stroke();pa(W,x)&&(I.lineWidth=1,I.strokeStyle="#fff",
I.beginPath(),I.moveTo(A,aa),I.lineTo(Ea,Sa),I.stroke())}I.beginPath();I.moveTo(A,aa);I.arc(A,aa,60,x.j-.16*m-.5*m,x.j+.16*m-.5*m);I.fillStyle=Pb(0,0,1,.5);I.fill();I.beginPath();I.arc(A,aa,5,0,2*m);I.fillStyle="red";I.fill();I.lineWidth=2;I.strokeStyle="#fff";I.stroke();P.drawImage(Hb,0,0,1024,1024,Eb,Fb,za,za)}P.strokeStyle="#fff";P.lineWidth=2;P.beginPath();P.rect(Eb,Fb,za,za);P.stroke()}else{{const t=(180*x.j/m+.5|0)-90,A=T/3,aa=T/3/180;O("center");for(let da=0,V=t,ra=A;180>=da;da++,V++,ra+=aa){const W=
ra+.5|0;for(var Fa=V;0>Fa;)Fa+=360;for(;360<=Fa;)Fa-=360;V=Fa;0===V%15&&(Ib[V]?(X(14),P.lineWidth=2,Qb(W,30,W,40),S(Ib[V],W,60)):(X(11),P.lineWidth=1,Qb(W,32,W,38),S(V.toString(),W,60)))}}X(18);P.fillStyle="#000";P.fillRect(T-130,20,40,30);O("center");var dd=xa(q),ed=T-110;P.fillStyle="#fff";P.fillText(dd,ed,42);P.fillStyle="#888";P.fillRect(T-90,20,80,30);O("left");var fd=T-85;P.fillStyle="#444";P.fillText("ALIVE",fd,42);{const t=Aa(q,q.B);t&&(X(24),O("center"),S("Ammo: "+t.D,Q,U-65))}{const t=Aa(q,
q.B);if(t){var Jc=Q-150,Kc=U-50,Gb=t.o/100;P.fillStyle=Pb(0,1-Gb,.5+.5*Gb);P.fillRect(Jc,Kc,300*Gb,20);P.strokeStyle="#fff";P.lineWidth=1;P.beginPath();P.rect(Jc,Kc,300,20);P.stroke()}}O("left");X(11);if(0<=q.currentTime){P.lineWidth=2;Qb(Q-30,R,Q+30,R);Qb(Q,R-30,Q,R+30);{let t=(q.currentTime|0)%60,A=.25*U|0;X(40);O("center");5>t?S("New Play Area marked on map",Q,A):20<=t&&25>t?S("Old Play Area goes OFFLINE in 10s!",Q,A):30<=t&&35>t&&S("Old Play Area going OFFLINE!",Q,A)}}else!q||0<=q.currentTime||
(O("center"),X(14),S("Starts in:",Q,R-60),X(60),console.log(-q.currentTime),S(-q.currentTime|0,Q,R));X(11);O("right");for(let t=0;t<Zb.length;t++)S(Zb[t],T-10,80+20*t)}X(11);O("center");S("Ping "+Ub.toFixed(0)+" ms",Q,U-10)}else Ob("YOU DIED");else Jb(),X(11),O("center"),S("Connecting...",Q,R+50);requestAnimationFrame(mc)}requestAnimationFrame(mc);function gc(){T=window.innerWidth;U=window.innerHeight;Q=T/2|0;R=U/2|0;dc&&(dc.width=T,dc.height=U);Z&&(Z.width=T,Z.height=U)}
function lc(){document.pointerLockElement===Z||document.mozPointerLockElement===Z?(document.addEventListener("mousemove",Lc,!1),ac=!0):(document.removeEventListener("mousemove",Lc,!1),ac=!1)}function Lc(a){const b=ec?1E-4:.001;x.j=ya(x.j+b*a.movementX);x.m=ya(x.m+b*a.movementY)};const Da=new Float32Array(3),kc=r(0,0,1),w=new Float32Array(3),rc=new Float32Array(3),qc=r(-1,1,1),Ta=Ga(),Ua=Ga(),oc=Ga(),pc=Ga(),y=dc.getContext("webgl",{alpha:!1,antialias:!1,premultipliedAlpha:!1}),Qa=Mc();
function Mc(){const a=y.createTexture();y.bindTexture(3553,a);y.texImage2D(3553,0,6408,1,1,0,6408,5121,new Uint8Array([0,0,255,255]));const b=new Image;b.onload=function(){y.bindTexture(3553,a);y.texImage2D(3553,0,6408,6408,5121,b);y.texParameteri(3553,10240,9728);y.texParameteri(3553,10241,9728);y.generateMipmap(3553)};b.src="textures.png";return a}
function Xb(a,b,c,e,d){var f=Vb;const h=n(Y,a,b)+c;{var g=r(a-c,h+c,b),k=r(a+c,h+c,b),l=r(a+c,h-c,b);const p=r(a-c,h-c,b);La(f,[g,k,l,p],e,0,d)}g=r(a,h+c,b-c);k=r(a,h+c,b+c);l=r(a,h-c,b+c);a=r(a,h-c,b-c);La(f,[g,k,l,a],e,0,d)}
function nc(a){for(let h=a.length-1;0<=h;h--){let g=a[h];if(!(0>=g.o||g.v===q.B)){switch(g.A){case 2:{var b=(5*(30+q.currentTime)|0)%4;3===b&&(b=1);var c=.001<Math.hypot(g.h,g.i),e=g.x-x.x;let k=g.z-x.z;var d=Math.hypot(e,k);let l=0;var f=0;0<d&&(e/=d,k/=d,f=Math.sin(g.j),d=Math.cos(g.j),l=e*f+k*d,f=e*d-k*f);e=!1;.7<l?c?(b=48+16*b,c=48):c=b=32:-.7>l?(b=c?48+16*b:0,c=32):(c?(b*=16,c=48):(b=16,c=32),e=0>f);Nc(g,1,b,c,e)}break;case 3:Nc(g,.05,48,0);break;case 13:Nc(g,.04,112,16);g.u-=4;break;case 14:Nc(g,
.5,32+16*Math.min(3,(16-g.u)/4|0),16);g.u--;break;case 6:Nc(g,.5,96,16);break;case 7:Nc(g,.5,112,0)}2!==g.A&&0===g.u&&a.splice(h,1)}}}function Nc(a,b,c,e,d){var f=a.x,h=a.y;a=a.z;var g=f-x.x,k=a-x.z,l=Math.hypot(g,k);g/=l;k/=l;l=d?-1:1;d=f-l*b*k;k=f+l*b*k;f=a+l*b*g;a-=l*b*g;g=h+b;h-=b;b=r(d,g,f);g=r(k,g,a);a=r(k,h,a);h=r(d,h,f);La(Wb,[b,g,a,h],c,e)};
